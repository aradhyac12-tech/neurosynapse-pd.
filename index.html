<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroCompass-PD v3.0 ğŸ§  | MDS-UPDRS Assessment</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- MediaPipe -->
    <script async src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils"></script>
    <script async src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils"></script>
    <script async src="https://cdn.jsdelivr.net/npm/@mediapipe/pose"></script>
    <script async src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <!-- ğŸ§  GLASSMORPHISM SPLASH SCREEN WITH VOICE -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <div class="splash-glass">
                <div class="splash-emoji-main" id="splashEmoji">ğŸ§ </div>
                <h1 class="splash-title">NeuroCompass</h1>
                <p class="splash-subtitle">ğŸ©º Digital Assessment Suite v3.0</p>
                
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                
                <p class="splash-status" id="splashStatus">Loading sensors...</p>
                
                <div class="splash-dots">
                    <span class="dot"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                </div>

                <!-- Voice Toggle on Splash -->
                <button id="splashVoiceBtn" class="splash-voice-btn" title="Enable Voice">ğŸ”Š Enable Voice</button>
            </div>
        </div>
    </div>

    <!-- HEADER -->
    <header class="header glass-effect">
        <div class="header-left">
            <button id="menuToggle" class="menu-btn">â˜°</button>
            <h1 class="logo">ğŸ§  NeuroCompass v3.0</h1>
        </div>
        <div class="header-right">
            <select id="topLanguageSelect" class="language-select">
                <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                <option value="hi">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                <option value="ru">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            </select>
            <button id="voiceBtn" class="voice-btn" title="Voice Assistant">ğŸ”Š</button>
        </div>
    </header>

    <!-- SIDEBAR -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>
    <nav id="sidebar" class="sidebar glass-effect">
        <div class="sidebar-header">
            <h2>ğŸ“± Navigation</h2>
            <button id="sidebarBack" class="close-btn">âœ•</button>
        </div>
        <div class="sidebar-nav">
            <a href="#" class="nav-item" data-view="dashboard">ğŸ  Dashboard</a>
            <a href="#" class="nav-item" data-view="info">ğŸ“– Info</a>
            <a href="#" class="nav-item" data-view="voice">ğŸ¤ Speech</a>
            <a href="#" class="nav-item" data-view="tremor">ğŸ“± Tremor</a>
            <a href="#" class="nav-item" data-view="gait">ğŸš¶ Gait</a>
            <a href="#" class="nav-item" data-view="facial">ğŸ˜Š Facial</a>
            <a href="#" class="nav-item" data-view="questions">â“ Questions</a>
            <a href="#" class="nav-item" data-view="spiral">âœï¸ Spiral</a>
            <a href="#" class="nav-item" data-view="results">ğŸ“Š Results</a>
            <a href="#" class="nav-item" data-view="report">ğŸ“„ Report</a>
        </div>
        <div class="sidebar-footer">
            <p>v3.0 | ğŸ§  NeuroCompass</p>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <!-- DASHBOARD -->
        <section id="dashboardView" class="view active">
            <div class="card glass-effect">
                <h2>ğŸš€ Clinical Dashboard</h2>
                <p>MDS-UPDRS Part III Digital Screening</p>

                <div class="dashboard-grid">
                    <div class="dashboard-box glass-effect" id="patientProfileBox">
                        <div class="box-icon">ğŸ‘¤</div>
                        <h3>Patient Profile</h3>
                        <p>Complete demographics first</p>
                        <button class="btn btn-primary" onclick="navigateTo('patient')">ğŸ‘‰ Create</button>
                    </div>
                    <div class="dashboard-box glass-effect">
                        <div class="box-icon">ğŸ”¬</div>
                        <h3>Screening Tests</h3>
                        <p>6 digital assessments</p>
                        <button class="btn btn-primary" onclick="navigateTo('voice')" id="testBtn" disabled>ğŸ§ª Tests</button>
                    </div>
                    <div class="dashboard-box glass-effect">
                        <div class="box-icon">ğŸ“Š</div>
                        <h3>Results Summary</h3>
                        <p>UPDRS domain scores</p>
                        <button class="btn btn-primary" onclick="navigateTo('results')" id="resultsBtn" disabled>ğŸ“ˆ View</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- INFO -->
        <section id="infoView" class="view">
            <div class="card glass-effect">
                <h2>ğŸ§  Parkinson's Disease</h2>
                <div class="info-grid">
                    <div class="info-box glass-effect">
                        <h3>What is PD?</h3>
                        <p>Progressive disorder with tremor, bradykinesia, rigidity and postural instability</p>
                    </div>
                    <div class="info-box glass-effect">
                        <h3>MDS-UPDRS Part III</h3>
                        <p>18 motor examination items scored 0-4 scale</p>
                    </div>
                    <div class="info-box glass-effect">
                        <h3>Digital Biomarkers</h3>
                        <p>Objective sensor-based clinical measurements</p>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="navigateTo('patient')">â¡ï¸ Start Assessment</button>
            </div>
        </section>

        <!-- PATIENT -->
        <section id="patientView" class="view">
            <div class="card glass-effect">
                <h2>ğŸ‘¤ Patient Profile (Age 18+)</h2>
                <form id="patientForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>First Name</label>
                            <input type="text" id="firstName" class="form-control glass-effect" required>
                        </div>
                        <div class="form-group">
                            <label>Last Name</label>
                            <input type="text" id="lastName" class="form-control glass-effect" required>
                        </div>
                        <div class="form-group">
                            <label>Date of Birth (18+ only)</label>
                            <input type="date" id="dateOfBirth" class="form-control glass-effect" required onchange="validateAge()">
                            <small id="ageError" style="color: #ef4444; display:none;">âš ï¸ Must be 18 or older</small>
                        </div>
                        <div class="form-group">
                            <label>Gender</label>
                            <select id="gender" class="form-control glass-effect" required>
                                <option value="">Select...</option>
                                <option value="M">â™‚ï¸ Male</option>
                                <option value="F">â™€ï¸ Female</option>
                                <option value="O">âš§ï¸ Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Country</label>
                            <select id="country" class="form-control glass-effect" required>
                                <option value="">Select Country...</option>
                                <option value="IN">ğŸ‡®ğŸ‡³ India (IN)</option>
                                <option value="KG">ğŸ‡°ğŸ‡¬ Kyrgyzstan (KG)</option>
                                <option value="US">ğŸ‡ºğŸ‡¸ United States (US)</option>
                                <option value="GB">ğŸ‡¬ğŸ‡§ United Kingdom (GB)</option>
                                <option value="RU">ğŸ‡·ğŸ‡º Russia (RU)</option>
                                <option value="DE">ğŸ‡©ğŸ‡ª Germany (DE)</option>
                                <option value="FR">ğŸ‡«ğŸ‡· France (FR)</option>
                                <option value="JP">ğŸ‡¯ğŸ‡µ Japan (JP)</option>
                                <option value="AU">ğŸ‡¦ğŸ‡º Australia (AU)</option>
                                <option value="CA">ğŸ‡¨ğŸ‡¦ Canada (CA)</option>
                                <option value="OTHER">ğŸŒ Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Phone (+Country Code)</label>
                            <div class="phone-group">
                                <span id="phoneCountryCode">+91</span>
                                <input type="tel" id="phone" class="form-control glass-effect" placeholder="1234567890" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="email" class="form-control glass-effect" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary full-width">ğŸ’¾ Save Profile & Lock</button>
                </form>
            </div>
        </section>

        <!-- VOICE -->
        <section id="voiceView" class="view">
            <div class="card glass-effect">
                <h2>ğŸ¤ Speech Assessment</h2>
                <p>Record 3 trials of "AAAAA" (5s each)</p>
                <div class="test-container">
                    <p class="trial-text">ğŸ¯ <span id="voiceTrial">Trial 1/3</span></p>
                    <canvas id="voiceWaveform" class="waveform-canvas"></canvas>
                    <div class="button-group">
                        <button id="voiceRecordBtn" class="btn btn-primary large">ğŸ¤ Record</button>
                        <button id="voiceStopBtn" class="btn btn-danger large" style="display:none">â¹ï¸ Stop</button>
                        <button id="voicePlayBtn" class="btn btn-secondary" style="display:none">â–¶ï¸ Play</button>
                    </div>
                    <div id="voiceMetrics" class="metrics-table" style="display:none"></div>
                    <button id="voiceCompleteBtn" class="btn btn-success full-width" style="display:none">âœ… Complete Speech</button>
                </div>
            </div>
        </section>

        <!-- TREMOR -->
        <section id="tremorView" class="view">
            <div class="card glass-effect">
                <h2>ğŸ“± Tremor Assessment</h2>
                <p>Hold phone steady 10s per hand</p>
                <div class="button-group">
                    <button class="btn btn-primary large" onclick="startTremorTest('left')">ğŸ‘ˆ Left Hand</button>
                    <button class="btn btn-primary large" onclick="startTremorTest('right')">ğŸ‘‰ Right Hand</button>
                </div>
                <div id="tremorCountdown" style="display:none">
                    <p class="countdown-text" id="tremorCountdownValue">10</p>
                    <canvas id="tremorWaveform" class="waveform-canvas"></canvas>
                    <div class="tremor-animation" id="tremorAnimation"></div>
                </div>
                <div id="tremorMetrics" class="metrics-table" style="display:none"></div>
            </div>
        </section>

        <!-- GAIT -->
        <section id="gaitView" class="view">
            <div class="card glass-effect">
                <h2>ğŸš¶ Gait Assessment</h2>
                <p>Walk in place - tracks ankles</p>
                <div class="camera-container">
                    <video id="gaitVideo" autoplay muted playsinline style="display:none"></video>
                    <canvas id="gaitCanvas" class="camera-canvas"></canvas>
                    <button id="gaitFlipBtn" class="btn btn-secondary camera-btn" style="display:none">ğŸ“· Flip</button>
                </div>
                <div class="button-group">
                    <button id="gaitStartBtn" class="btn btn-primary large">ğŸš¶ Start Recording</button>
                    <button id="gaitStopBtn" class="btn btn-danger large" style="display:none">â¹ï¸ Stop</button>
                </div>
                <div id="gaitMetrics" class="metrics-table" style="display:none"></div>
            </div>
        </section>

        <!-- FACIAL -->
        <section id="facialView" class="view">
            <div class="card glass-effect">
                <h2>ğŸ˜Š Facial Assessment</h2>
                <p>Tracks blink rate & expressions</p>
                <div class="camera-container">
                    <video id="facialVideo" autoplay muted playsinline style="display:none"></video>
                    <canvas id="facialCanvas" class="camera-canvas"></canvas>
                    <button id="facialFlipBtn" class="btn btn-secondary camera-btn" style="display:none">ğŸ“· Flip</button>
                </div>
                <div class="button-group">
                    <button id="facialStartBtn" class="btn btn-primary large">ğŸ˜Š Start Recording</button>
                    <button id="facialStopBtn" class="btn btn-danger large" style="display:none">â¹ï¸ Stop</button>
                </div>
                <div id="facialMetrics" class="metrics-table" style="display:none"></div>
            </div>
        </section>

        <!-- QUESTIONS -->
        <section id="questionsView" class="view">
            <div class="card glass-effect">
                <h2>â“ Questions</h2>
                <form id="questionsForm">
                    <div class="form-group">
                        <label>1. Do you experience slowness of movement? ğŸ¢</label>
                        <select class="form-control glass-effect question-answer" required>
                            <option value="">Select...</option>
                            <option value="0">No</option>
                            <option value="1">Sometimes</option>
                            <option value="2">Often</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>2. Do you have stiffness or rigidity? ğŸ’ª</label>
                        <select class="form-control glass-effect question-answer" required>
                            <option value="">Select...</option>
                            <option value="0">No</option>
                            <option value="1">Sometimes</option>
                            <option value="2">Often</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>3. Do you have balance issues? âš–ï¸</label>
                        <select class="form-control glass-effect question-answer" required>
                            <option value="">Select...</option>
                            <option value="0">No</option>
                            <option value="1">Sometimes</option>
                            <option value="2">Often</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary full-width">ğŸ’¾ Save Answers</button>
                </form>
            </div>
        </section>

        <!-- SPIRAL -->
        <section id="spiralView" class="view">
            <div class="card glass-effect">
                <h2>âœï¸ Spiral Drawing</h2>
                <div class="spiral-grid">
                    <div>
                        <h4>Reference ğŸ“‹</h4>
                        <canvas id="spiralReference" class="spiral-canvas"></canvas>
                    </div>
                    <div>
                        <h4>Your Drawing âœï¸</h4>
                        <canvas id="spiralCanvas" class="spiral-canvas"></canvas>
                    </div>
                </div>
                <div class="button-group">
                    <button id="spiralStartBtn" class="btn btn-primary">âœï¸ Draw</button>
                    <button id="spiralClearBtn" class="btn btn-secondary" style="display:none">ğŸ—‘ï¸ Clear</button>
                    <button id="spiralSaveBtn" class="btn btn-success" style="display:none">ğŸ’¾ Save</button>
                </div>
                <div id="spiralMetrics" class="metrics-table" style="display:none"></div>
            </div>
        </section>

        <!-- RESULTS -->
        <section id="resultsView" class="view">
            <div class="card glass-effect">
                <h2>ğŸ“Š Results Summary</h2>
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Assessment</th>
                            <th>Score (0-4)</th>
                            <th>Severity</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ğŸ¤ Speech</td>
                            <td id="rptVoiceScore">-</td>
                            <td id="rptVoiceSev">-</td>
                        </tr>
                        <tr>
                            <td>ğŸ“± Tremor</td>
                            <td id="rptTremorScore">-</td>
                            <td id="rptTremorSev">-</td>
                        </tr>
                        <tr>
                            <td>ğŸš¶ Gait</td>
                            <td id="rptGaitScore">-</td>
                            <td id="rptGaitSev">-</td>
                        </tr>
                        <tr>
                            <td>ğŸ˜Š Facial</td>
                            <td id="rptFacialScore">-</td>
                            <td id="rptFacialSev">-</td>
                        </tr>
                        <tr>
                            <td>â“ Questions</td>
                            <td id="rptQuestScore">-</td>
                            <td id="rptQuestSev">-</td>
                        </tr>
                        <tr>
                            <td>âœï¸ Spiral</td>
                            <td id="rptSpiralScore">-</td>
                            <td id="rptSpiralSev">-</td>
                        </tr>
                    </tbody>
                </table>
                <button class="btn btn-primary full-width" onclick="navigateTo('report')">ğŸ“„ Generate Report</button>
            </div>
        </section>

        <!-- REPORT -->
        <section id="reportView" class="view">
            <div class="card glass-effect" id="reportContent">
                <h2>ğŸ“„ Clinical Report</h2>
                <div id="reportInfo">Complete all assessments to generate report</div>
                <button class="btn btn-primary full-width" onclick="downloadPDF()" id="downloadPdfBtn" style="display:none">ğŸ“¥ Download PDF</button>
            </div>
        </section>
    </main>

    <script src="languages.js"></script>
    <script src="assessment.js"></script>
</body>
</html>
